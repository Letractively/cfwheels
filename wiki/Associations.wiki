#summary Through some simple configuration, Wheels allows you to unlock some powerful functionality to use your database tables' relationships in your controller code.
#labels chapter,0.8.3

_Associations_ in Wheels allow you to define the relationships between your database tables. After configuring these relationships, doing pesky table joins becomes a trivial task. And like all other ORM functions in Wheels, this is done without writing a single line of SQL.

==3 Types of Associations==

In order to set up associations, you only need to remember 3 simple functions. Considering that the human brain only reliably remembers up to 7 items, we've left you with a lot of extra space. You're welcome. :)

The association functions should always be called in the `init()` method of a model that relate to another model within your application.

===`belongsTo` Association===

If your database table contains a field that is a foreign key to another table, then this is where to use the `belongsTo()` function.

If we had a `comments` table that contains a foreign key to the `posts` table called `postId`, then we should have this `init()` method within our `Comment` model:

{{{
<cfcomponent extends="Model">

    <cffunction name="init">
        <cfset belongsTo("Post")>
    </cffunction>

</cfcomponent>
}}}

===`hasOne` and `hasMany` Associations===

On the other side of the relationship are the "has" functions. As you may have astutely guessed, these functions should be used according to the nature of the model relationship.

At this time, you need to be a little eccentric and talk to yourself. Your association should make sense in plain English language.

===An example of `hasMany()`===

So let's consider the `Post`/`Comment` relationship mentioned above for `belongsTo()`. If we were to talk to ourselves, we would say, "A post _has many_ comments." And that's how you should construct your `Post` model:

{{{
<cfcomponent extends="Model">

    <cffunction name="init">
        <cfset hasMany("Comments")>
    </cffunction>

</cfcomponent>
}}}

You may be a little concerned because our model is called `Comment` and not `Comments`. No need to worry: Wheels understands the need for the plural in conjunction with the `hasMany()` function.

And don't worry about those pesky words in the English language that aren't pluralized by just adding an "s" to the end. Wheels is smart enough to know that words like "deer" and "children" are the plurals of "deer" and "child," respectively.

===An example of `hasOne()`===

If we continue our pattern of talking to ourselves, then we could easily figure out to use `hasOne()` to set up a similar relationship.

Let's use the relationship between post and author as an example. So we'd say, "A post _has one_ author." That is, if that really is your business rule. Seems reasonable.

If our `Author` model looked like this:

{{{
<cfcomponent extends="Model">

    <cffunction name="init">
        <cfset belongsTo("Post")>
    </cffunction>

</cfcomponent>
}}}

Then our `Post` model would look like this:

{{{
<cfcomponent extends="Model">

    <cffunction name="init">
        <cfset hasOne("Author")>
    </cffunction>

</cfcomponent>
}}}

As you can see, you do not pluralize "author" in this case because there is only one author.

==Database Table Setup==

Like everything else in Wheels, we strongly recommend a default naming convention for foreign key columns in your database tables.

In this case, the convention is to use the singular name of the related table with `Id` appended to the end. So to link up our table to the `employees` table, the foreign key column should be named `employeeId`.

===Breaking the convention===

Wheels offers a way to configure your models to break this naming convention, however. This is done by using the `foreignKey` argument in your model's `belongsTo()` calls.

Let's pretend that you have a relationship between `Author` and `Post`, but you didn't use the naming convention and instead called the column `post_id`. (You just can't seem to let go of the underscores, can you?)

Your `Post`'s `init()` function would then need to look like this:

{{{
<cfcomponent extends="model">

    <cffunction name="init">
        <cfset belongsTo(name="Author", foreignKey="post_id")>
    </cffunction>

</cfcomponent>
}}}

==Leveraging Model Associations in Your Application==

Now that we have our associations set up, let's use them to get some data into our applications.

There are a couple ways to join data via associations, which we'll go over now.

==Using the `include` Argument in Your Finders==

To include data from related tables in our "find" calls, we simply need to use the `include` argument. Let's say that we wanted to include data about the `Author` in our `findByKey()` call for a `Post`.

Here's what that call would look like:

{{{
<cfset post = model("Post").findByKey(key=params.key, include="Author")>
}}}

It's that simple. Wheels will then join the `authors` table automatically so that you can use that data along with the data from `posts`.

===Naming Collisions===

There is a minor caveat to this approach. If you have a column in both associated tables with the same name, Wheels will pick just one to represent that column.

In order to include both columns, you can override this behavior with the `select` argument in the finder functions.

For example, if we had a column named `id` in both your `posts` and `authors` tables, then you could use the `select` argument like so:

{{{
<cfset post = model("Post").findAll(select="posts.id, posts.title, authors.id, authors.name", include="Author")>
}}}

You would need to hard-code all column names that you need in that case, which does remove some of the simplicity. There are always trade-offs!